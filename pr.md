---
model: claude-sonnet-4-20250514
---

# /pr - プルリクエスト自動作成

## 概要
プッシュ済みのブランチの変更内容を分析して、`gh`コマンドでプルリクエストを自動作成するスラッシュコマンドです。
**注意**: このコマンドを実行する前に、ブランチがすでにリモートにプッシュされている必要があります。

## 使用方法

```bash
# 現在のブランチからメインブランチに対してプルリクエストを作成（セッション中の変更のみ）
/pr

# 現在のブランチから指定したブランチに対してプルリクエストを作成（セッション中の変更のみ）
/pr staging
/pr develop
/pr main

# 送信元/送信先ブランチを明示的に指定してプルリクエスト作成（セッション中の変更のみ）
/pr staging main
/pr feature/login staging
/pr hotfix/bug main

# ブランチの全コミット履歴を含めてプルリクエストを作成（従来の動作）
/pr --all
/pr staging --all
/pr feature/login main --all
```

## 実行内容

1. プッシュ済みブランチの状態を確認
2. **デフォルト動作を変更**: 現在のセッション開始時のコミット（会話開始時のHEAD）から現在までの変更のみを分析
   - セッション開始時のコミットハッシュを基点として使用
   - `git log <session_start_commit>..HEAD`で対象コミットを限定
   - セッション中に作成されたコミットのみをPRに含める
3. 送信先ブランチとの差分を確認（セッション中の変更のみ）
4. セッション中のコミットメッセージから適切なプルリクエストタイトルを生成
5. セッション中の変更内容の概要とテストプランを作成
6. `gh pr create --base <送信先ブランチ> --head <送信元ブランチ>`でGitHubプルリクエストを自動作成

## 引数

- 引数なし: 現在のブランチからmainに対してプルリクエスト作成（セッション中の変更のみ）
- `<送信先ブランチ>`: 現在のブランチから指定ブランチに対してプルリクエスト作成（セッション中の変更のみ）
- `<送信元ブランチ> <送信先ブランチ>`: 指定送信元ブランチから指定送信先ブランチに対してプルリクエスト作成（セッション中の変更のみ）
- `--all`: 従来の動作（ブランチの全コミット履歴を含める）でプルリクエストを作成

## 自動生成される内容

コミット履歴と変更内容を分析して、以下を自動生成します：

### プルリクエストタイトル
- コミットメッセージから最も重要な変更を抽出
- feat/fix/refactor等のプレフィックスも適切に付与
- 例: `feat: ユーザー認証機能の追加` `fix: ログイン時のバリデーションエラー修正`

### プルリクエスト本文
```markdown
## 概要
- 変更内容の概要をまとめた項目（指定ベースブランチとの差分から生成）
- 主要な機能追加や修正点を明記

## テストプラン
- [ ] 新機能の動作確認
- [ ] 既存機能への影響確認
- [ ] エラーハンドリングの確認

🤖 Claude Codeで生成
```

### 実行されるコマンド
```bash
gh pr create --title "生成されたタイトル" --body "$(cat <<'EOF'
生成されたマークダウン本文
EOF
)"
```

## 前提条件

- GitHubリポジトリが設定されていること
- `gh` コマンドラインツールがインストール済みであること
- 現在のブランチにコミットが存在すること
- **ブランチがすでにリモートにプッシュされていること**
- 指定したターゲットブランチが存在すること